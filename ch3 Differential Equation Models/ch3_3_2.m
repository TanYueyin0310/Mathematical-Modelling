%Date:2020/3/17
%Author: TAN Yueyin
%人口预测模型--Logistic模型
%% 输入数据
xdata = 1982 : 1999;
ydata = [10.1654 10.3008 10.4357 10.5851 10.7507 10.9300 11.1026 11.2704 11.4333 11.5823 11.7171 11.8517 11.9850 12.1121 12.2389 12.3626 12.4761 12.5786 ]
a0 = [15.3656 0.01506 10];%a0 = [N_m, r, N0]
n0 = 10.1654;
%% 用最小二乘法拟合获得估计的增长率r, N_m
[a, Resnorm] = lsqcurvefit(@ch3_3_2_logistic, a0, xdata, ydata)
yfit = a(1) ./ ( 1 + (a(1) / a(3) - 1 ) * exp( - a(2) * (xdata - 1982)));
%% 画图
xdata1 = 1982 : 2010;
ydata1 = [10.1654 10.3008 10.4357 10.5851 10.7507 10.9300 11.1026 11.2704 11.4333 11.5823 11.7171 11.8517 11.9850 12.1121 12.2389 12.3626 12.4761 12.5786 12.6743 12.7627 12.8453 12.9227 12.9988 13.0756 13.1448 13.2129 13.2802 13.3450 13.4091 ]
yfit1 = a(1) ./ ( 1 + (a(1) / a(3) - 1 ) * exp( - a(2) * (xdata1 - 1982)));
plot(xdata1, ydata1, '*b', xdata1, yfit1, '-r');
xlabel('Year');
ylabel('Population/10^8');